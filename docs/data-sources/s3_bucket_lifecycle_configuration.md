---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "storagegrid_s3_bucket_lifecycle_configuration Data Source - storagegrid"
subcategory: ""
description: |-
  Fetches lifecycle configuration for a StorageGrid S3 bucket.
---

# storagegrid_s3_bucket_lifecycle_configuration (Data Source)

Fetches lifecycle configuration for a StorageGrid S3 bucket.

## Example Usage

```terraform
# Look up lifecycle configuration for the foo bucket
data "storagegrid_s3_bucket_lifecycle_configuration" "foo" {
  bucket_name = "foo-bucket"
}

# Look up lifecycle configuration for the bar bucket
data "storagegrid_s3_bucket_lifecycle_configuration" "bar" {
  bucket_name = "bar-bucket"
}

# Use lifecycle data to understand existing rules
locals {
  foo_has_expiration_rules = length([
    for rule in data.storagegrid_s3_bucket_lifecycle_configuration.foo.rule :
    rule if rule.expiration != null
  ]) > 0

  foo_max_expiration_days = max([
    for rule in data.storagegrid_s3_bucket_lifecycle_configuration.foo.rule :
    rule.expiration != null && rule.expiration.days != null ? rule.expiration.days : 0
  ]...)
}

# Create additional lifecycle rules based on existing configuration
resource "storagegrid_s3_bucket_lifecycle_configuration" "foo_additional" {
  count       = local.foo_has_expiration_rules ? 1 : 0
  bucket_name = "foo-additional-bucket"

  rule {
    id     = "foo-additional-cleanup"
    status = "Enabled"

    filter {
      prefix = "backup/"
    }

    # Set expiration based on existing rules
    expiration {
      days = local.foo_max_expiration_days * 2
    }
  }
}

# Output lifecycle information
output "foo_lifecycle_rules_count" {
  value = length(data.storagegrid_s3_bucket_lifecycle_configuration.foo.rule)
}

output "foo_lifecycle_rules" {
  value = [
    for rule in data.storagegrid_s3_bucket_lifecycle_configuration.foo.rule : {
      id              = rule.id
      status          = rule.status
      prefix          = rule.filter != null ? rule.filter.prefix : null
      expiration_days = rule.expiration != null ? rule.expiration.days : null
    }
  ]
}

output "bar_lifecycle_id" {
  value = data.storagegrid_s3_bucket_lifecycle_configuration.bar.id
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `bucket_name` (String) The name of the S3 bucket to fetch lifecycle configuration for.

### Optional

- `rule` (Block List) Lifecycle rules for the bucket. (see [below for nested schema](#nestedblock--rule))

<a id="nestedblock--rule"></a>
### Nested Schema for `rule`

Optional:

- `expiration` (Block, Optional) Expiration settings for current object versions. (see [below for nested schema](#nestedblock--rule--expiration))
- `filter` (Block, Optional) Filter for the lifecycle rule. (see [below for nested schema](#nestedblock--rule--filter))
- `noncurrent_version_expiration` (Block, Optional) Expiration settings for noncurrent object versions. (see [below for nested schema](#nestedblock--rule--noncurrent_version_expiration))

Read-Only:

- `id` (String) Unique identifier for the rule.
- `status` (String) Status of the rule (Enabled or Disabled).

<a id="nestedblock--rule--expiration"></a>
### Nested Schema for `rule.expiration`

Optional:

- `date` (String) Date when objects expire (ISO 8601 format).
- `days` (Number) Number of days after object creation when the object expires.


<a id="nestedblock--rule--filter"></a>
### Nested Schema for `rule.filter`

Optional:

- `prefix` (String) Object key prefix that identifies the objects to which the rule applies.


<a id="nestedblock--rule--noncurrent_version_expiration"></a>
### Nested Schema for `rule.noncurrent_version_expiration`

Optional:

- `noncurrent_days` (Number) Number of days after an object becomes noncurrent when it expires.
